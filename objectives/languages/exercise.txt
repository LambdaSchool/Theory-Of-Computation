Look for Compile Errors:

the while expression is messing a 'DO' after it